<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>OUR Chicken Cloud</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bluebird/3.3.4/bluebird.min.js"></script>
    <script src="https://secure.aadcdn.microsoftonline-p.com/lib/1.0.0/js/msal.js"></script>
    <style>
        strong {
            color: black;
            -webkit-text-fill-color: black;
            -webkit-text-stroke-width: 2px;
            -webkit-text-stroke-color: white;
            font-family: Arial, Helvetica, sans-serif;
            font-size: 80px;
        }

        .collapsible {
            background-color: #777;
            color: white;
            cursor: pointer;
            padding: 18px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 18px;
        }

        .active,
        .collapsible:hover {
            background-color: #555;
        }

        .content {
            padding: 0 18px;
            display: none;
            overflow: hidden;
            background-color: #f1f1f1;
        }
    </style>
</head>

<body style="background-image: url(/css/Ciel.jpg);background-size: 1525px 1320px;">
    <div class="container">
        <center>
            <h1 style="color:black;font-size:40px;text-shadow: black">
                <strong>
                    OUR Chicken Cloud Services
                </strong>
              
                <h0>_______________________________________________________________ </h0>
               <span> <h5>
                 <form action="/creatergroup">
                     Enter Your Name:&emsp;&emsp14;&emsp14;<input type="text" id="rgroup" name="rgroup" value=""
                                    required>
                     <input type="button" id="rgroupbut"></h5></span>

                <!-- Network -->
                <form action="/network" method="GET">
                    Build a Network
                    <div class="createnetwork">
                        <span class="collapsible">Build Network</span>
                        <p class="content" style="background-color: #ffffff;
                        border: 1px solid black; opacity: 0.5; margin: 50px; color: black; font-size: 20px">
                            <form action="">
                                Virtual Network Name:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<input type="text"
                                    id="vnetname" name="vnetname"value="" required><br>
                                CIDR Address Prefixes with mask:&emsp;&emsp;&emsp;<input type="text"
                                    id="vnetip" name="vnetip" pattern="[0-9].{15}+/[0-9].{1}" 
                                    title="Input must be in CIDR format" value="" required><br>
                                Private Vnet Subnet Name:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp13;<input type="text"
                                    id="privatevnetsubnet" name="privatevnetsubnet" value="" required><br>
                                Private CIDR Address Prefixes with mask:<input type="text"
                                    id="privatevnetip" name="privatevnetip" pattern="[0-9].{15}+/[0-9].{1}" 
                                    title="Input must be in CIDR format" value="" required><br>
                                Public Vnet Subnet Name:&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp13;&emsp13;<input type="text"
                                    id="publicvnetsubnet" name="publicvnetsubnet" value="" required><br>
                                Public CIDR Address Prefixes with mask:&emsp14;<input type="text"
                                    id="publicvnetip" name="publicvnetip" pattern="[0-9].{15}+/[0-9].{1}" 
                                    title="Input must be in CIDR format" value="" required><br>
                                <input type="button" onclick="Network()" value="Review Network">
                                <input type="reset">
                                <br>
                                <input type="text" id="reviewnetwork" size="150" disabled>
                                <br>
                                <h0>__________________________________________________________________
                                </h0>
                                <br>
                                <input type="submit" value="Create Network">
                            </form>
                        </p>
                    </div>
                </form>

                <!--VM -->
                <form action="/createvm" method="GET">
                    Build a Virtual Machine
                    <div class="createvm">
                        <span class="collapsible">Build VM</span>
                        <p class="content" style="background-color: #ffffff;
                        border: 1px solid black; opacity: 0.5; margin: 50px; color: black; font-size: 20px">
                            <form action="">
                                VM name:&emsp;&emsp;&emsp;&emsp14;&emsp14;<input type="text" id="VMname" name="VMname" value=""
                                    required><br>
                                Attached Vnet:&emsp;&emsp14;&emsp14;<input type="text" id="VMnetwork" name="VMnetwork" value=""
                                    required><br>
                                Vnet  Subnet:&emsp;&emsp;&emsp14;<input type="text" id="VMsubnet" name="VMsubnet" value=""
                                    required><br>
                                Admin Username: <input type="text" id="VMuser" name="VMuser" value="" required><br>
                                Admin Password:&emsp14; <input type="password" id="VMpassword" name="VMpassword"
                                    pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" 
                                    title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters" 
                                    value="" required><br>
                                <input type="button" onclick="VM()" value="Review VM">
                                <input type="reset"><br>
                                <input type="text" id="reviewvm" size="50" disabled>
                                <br>
                                <h0>__________________________________________________________________ </h0>
                                <br>
                                <input type="submit" value="Create VM">
                            </form>
                        </p>
                    </div>
                </form>

                <!-- Directory Users -->
                <form action="/users" method="GET">
                    Update Directory Users
                    <div class="createdir">
                        <span class="collapsible">Update directory Users</span>
                        <p class="content" style="background-color: #ffffff;
                        border: 1px solid black; opacity: 0.5; margin: 50px; color: black; font-size: 20px">
                            <form action="">
                                <select id="dirAction" name="dirAction" required>
                                    <option value=""> ---Please Select an Action---</option>
                                    <option value="create">Create User</option>
                                    <option value="delete">Delete User</option>
                                </select><br>
                                Enter Username: <input type="text" id="dirUsername" name="dirUsername" value="" required><br>
                                <input type="button" onclick="userDir()" value="Review Directory">
                                <input type="reset">
                                <br>
                                <input type="text" id="reviewDir" size="75" disabled>
                                <br>
                                <h0>__________________________________________________________________ </h0>
                                <br>
                                <input type="submit" value="Update Directory Users">
                            </form>
                        </p>
                    </div>
                </form>

                <!-- Directory Roles -->
                <form action="/roles" method="GET">
                    Update Directory Roles
                    <div class="dirroles">
                        <span class="collapsible">Update directory Roles</span>
                        <p class="content" style="background-color: #ffffff;
                            border: 1px solid black; opacity: 0.5; margin: 50px; color: black; font-size: 20px">
                            <form action="">
                                <select id="roleAction" name="roleAction" required>
                                    <option value=""> ---Please Select an Action---</option>
                                    <option value="create">Create Role</option>
                                    <option value="delete">Delete Role</option>
                                </select><br>
                                <select id="roleType" name="roleType" required>
                                    <option value=""> -----Please Select a Role-----</option>
                                    <option value="reader">Reader Role</option>
                                    <option value="contributor">Contributor Role</option>
                                    <option value="owner">Administrator Role</option>
                                </select><br>
                                Enter Username: <input type="text" id="roleUsername" name="roleUsername" value="" required><br>
                                <input type="button" onclick="dirRoles()" value="Review Directory Roles">
                                <input type="reset">
                                <br>
                                <input type="text" id="reviewdirRoles" size="75" disabled>
                                <br>
                                <h0>__________________________________________________________________ </h0>
                                <br>
                                <input type="submit" value="Update Directory Roles">
                            </form>
                        </p>
                    </div>
                </form>

                <!-- Web App -->
                <form action="/webapp" method="GET">
                    Build a Web App
                    <div class="createwebapp">
                        <span class="collapsible">Build Webapp</span>
                        <p class="content" style="background-color: #ffffff;
                        border: 1px solid black; opacity: 0.5; margin: 50px; color: black; font-size: 20px">
                            <form action="">
                                WebApp Name: <input type="text" id="webappname" name="webappname" value="" required><br>
                                Git Repository: &emsp13;&emsp13;<input type="text" id="gitrepo" name="gitrepo" value="" required><br>
                                <input type="button" onclick="webApp()" value="Review WebApp">
                                <input type="reset">
                                <br>
                                <input type="text" id="reviewWebapp" size="75" disabled>
                                <br>
                                <h0>__________________________________________________________________ </h0>
                                <br>
                                <input type="submit" value="Create WebApp">
                            </form>
                        </p>
                    </div>
                </form>

                <!-- Blod Storage -->
                <form action="/blob" method="GET">
                    Build Blob Storage
                    <div class="createblob">
                        <span class="collapsible">Build Storage</span>
                        <p class="content" style="background-color: #ffffff;
                        border: 1px solid black; opacity: 0.5; margin: 50px; color: black; font-size: 20px">
                            <form action="">
                                Storage Name: <input type="text" id="storagename" name="storagename" value="" required><br>
                                Container Name: <input type="text" id="containername" name="containername" value="" required><br>
                                <input type="button" onclick="storageCreate()" value="Review Storage">
                                <input type="reset">
                                <br>
                                <input type="text" id="reviewStorage" size="50" disabled>
                                <br>
                                <h0>__________________________________________________________________ </h0>
                                <br>
                                <input type="submit" value="Create Storage">
                            </form>
                        </p>
                    </div>
                </form>

                <!-- SQL Database -->
                <form action="/sqldb" method="GET">
                    Build a SQL database
                    <div class="createsql">
                        <span class="collapsible">Build MySQL-DB</span>
                        <p class="content" style="background-color: #ffffff;
                        border: 1px solid black; opacity: 0.5; margin: 50px; color: black; font-size: 20px">
                            <form action="">
                                SQL Server Name:&emsp;&emsp;&emsp;<input type="text" id="sqlserver" name="sqlserver" value=""
                                    required><br>
                                Server Admin Username: <input type="text" id="sqlusername" name="sqlusername" value="" required><br>
                                Server Admin Password:&emsp14; <input type="password" id="sqlpassword" name="sqlpassword" 
                                    pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" 
                                    title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters" 
                                    value="" required><br>
                                Database Name:&emsp;&emsp;&emsp;&emsp; <input type="text" id="sqldbname" name="sqldbname" value=""
                                    required><br>
                                <input type="button" onclick="createSQL()" value="Review SQL Database">
                                <input type="reset">
                                <br>
                                <input type="text" id="reviewSQL" size="100" disabled>
                                <br>
                                <h0>__________________________________________________________________
                                </h0>
                                <br>
                                <input type="submit" value="Create SQL Database">
                            </form>
                        </p>
                    </div>
                </form>

                <!-- Kos-mos DB -->
                <form action="/cosmos" method="GET">
                    Build a Cosmos Database
                    <div class="createcosmosDB">
                        <span class="collapsible">Build CosmosDB</span>
                        <p class="content" style="background-color: #ffffff;
                        border: 1px solid black; opacity: 0.5; margin: 50px; color: black; font-size: 20px">
                            <form action="">
                                CosmosDB Account Name:&emsp13;&emsp14;&emsp14;<input type="text" id="cosmosaccount"
                                    name="cosmosaccount" value="" required><br>
                                CosmosDB Name:&emsp;&emsp;&emsp;&emsp;&emsp13; <input type="text" id="cosmosdbname"
                                    name="cosmosdbname" value="" required><br>
                                CosmosDB Collection Name:<input type="text" id="cosmosdbcollection" name="cosmosdbcollection" 
                                    value="" required><br>
                                <input type="button" onclick="createKosmos()" value="Review CosmosDB">
                                <input type="reset">
                                <br>
                                <input type="text" id="reviewCosmosDB" size="80" disabled>
                                <br>
                                <h0>__________________________________________________________________ </h0>
                                <br>
                                <input type="submit" value="Create CosmosDB">
                            </form>
                        </p>
                    </div>
                </form>
            </h1>
        </center>
    </div>
    <h0>________________________________________________________________________________________________________________________________________________________________________
    </h0><br>
    <center>
    <footer><br>
            <button type="button" style="font-size: 20px" id="SignOut">Log Out</button>
            <br>
    </footer>
    </center>

    <!-- Javascript -->
    <!-- Collapsible Javascripts -->
    <script>
        var coll = document.getElementsByClassName("collapsible");
        var i;
        for (i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function () {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.display === "block") {
                    content.style.display = "none";
                } else {
                    content.style.display = "block";
                }
            });
        }

        //Create Network
        function Network() {
            var a = document.getElementById("vnetname").value;
            var b = document.getElementById("vnetip").value;
            var d = document.getElementById("privatevnetsubnet").value;
            var e = document.getElementById("privatevnetip").value;
            var g = document.getElementById("publicvnetsubnet").value;
            var h = document.getElementById("publicvnetip").value;
            document.getElementById("reviewnetwork").value = 'You want a Network with:' + [a, b, d, e, g, h];
        }

        //Create VM 
        function VM() {
            var a = document.getElementById("VMname").value;
            var b = document.getElementById("VMnetwork").value;
            var c = document.getElementById("VMuser").value;
            var d = document.getElementById("VMpassword").value;
            document.getElementById("reviewvm").value = 'You want a VM with:' + [a, b, c, d];
        }

        //Update Directory Users
        function userDir() {
            var a = document.getElementById("dirAction").value;
            var b = document.getElementById("dirUsername").value;
            document.getElementById("reviewDir").value = 'You want to update Directory users with:' + [a, b];
        }

        //Update Directory Roles
        function dirRoles() {
            var a = document.getElementById("roleAction").value;
            var b = document.getElementById("roleUsername").value;
            var c = document.getElementById("roleType").value;
            document.getElementById("reviewdirRoles").value = 'You want to update Directory Roles with:' + [a, b, c];
        }

        //Create a Web App
        function webApp() {
            var a = document.getElementById("webappname").value;
            var b = document.getElementById("webappplan").value;
            document.getElementById("reviewWebapp").value = 'You want to create a WebApp with:' + [a, b];
        }

        //Blod Storage
        function storageCreate() {
            var a = document.getElementById("storagename").value;
            var b = document.getElementById("containername").value;
            document.getElementById("reviewStorage").value = 'You want to create Blob Storage with Name:' + [a,b];
        }

        //Create an SQL Database
        function createSQL() {
            var a = document.getElementById("sqlserver").value;
            var b = document.getElementById("sqlusername").value;
            var c = document.getElementById("sqlpassword").value;
            var d = document.getElementById("sqldbname").value;
            document.getElementById("reviewSQL").value = 'You want to create a SQL Database with:' + [a, b, c, d];
        }

        //Create a Cosmos Database
        function createKosmos() {
            var a = document.getElementById("cosmosaccount").value;
            var b = document.getElementById("cosmosdbname").value;
            var c = document.getElementById("cosmosdbcollection").value;
            document.getElementById("reviewCosmosDB").value = 'You want to create a Cosmos Database with:' + [a, b, c];
        }

        // Create Sign Out
        var msalConfig = {//4695b616-04cf-4063-a769-ab51fd8a88fd tenant ID
            token: 'H7:3kRY0+.=y5v3]iRBNq1l_qar[43Zc',
            auth: {
                clientId: "8d935332-418d-4811-a99a-298cd54381bf", //le chicken ID
                authority: "https://login.microsoftonline.com/4695b616-04cf-4063-a769-ab51fd8a88fd",
            },
            cache: {
                cacheLocation: "localStorage",
                storeAuthStateInCookie: true
            }
        };
        var graphConfig = {
            graphMeEndpoint: "https://graph.microsoft.com/v1.0/me"
        };
        var requestObj = {
            scopes: ["user.read"]
        };
        
        function callMSGraph(theUrl, accessToken, callback) {
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200)
            callback(JSON.parse(this.responseText));
    }
    xmlHttp.open("GET", theUrl, true); // true for asynchronous
    xmlHttp.setRequestHeader('Authorization', 'Bearer ' + accessToken);
    xmlHttp.send();
}


        function authRedirectCallBack(error, response) {
            if (error) {
                console.log(error);
            }
            else {
                if (response.tokenType === "access_token") {
                    callMSGraph(graphConfig.graphEndpoint, response.accessToken, graphAPICallback);
                } else {
                    console.log("token type is:" + response.tokenType);
                }
            }
        }

        

        var myMSALObj = new Msal.UserAgentApplication(msalConfig);
        // Register Callbacks for redirect flow
        myMSALObj.handleRedirectCallback(authRedirectCallBack);

        if (! myMSALObj.getAccount().userName){
            window.location.replace("https://paastrial.azurewebsites.net/")
        }
function acquireTokenPopupAndCallMSGraph() {
    //Always start with acquireTokenSilent to obtain a token in the signed in user from cache
    myMSALObj.acquireTokenSilent(requestObj).then(function (tokenResponse) {
        callMSGraph(graphConfig.graphMeEndpoint, tokenResponse.accessToken, graphAPICallback);
    }).catch(function (error) {
        console.log(error);
        // Upon acquireTokenSilent failure (due to consent or interaction or login required ONLY)
        // Call acquireTokenPopup(popup window)
        if (requiresInteraction(error.errorCode)) {
            myMSALObj.acquireTokenPopup(requestObj).then(function (tokenResponse) {
                callMSGraph(graphConfig.graphMeEndpoint, tokenResponse.accessToken, graphAPICallback);
            }).catch(function (error) {
                console.log(error);
            });
        }
    });
}

        function signOut() {
            myMSALObj.logout();
        }
        var loginbutton = document.getElementById("SignOut");
        loginbutton.setAttribute('onclick', 'signOut();');

    </script>

</body>

</html>
